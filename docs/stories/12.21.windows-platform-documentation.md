# Story 12.21: Windows Platform Limitations Documentation

**Status:** Complete
**Priority:** Low
**Depends on:** None

---

## Context / Background

An external audit (GPT-5.2 assessment, 2026-01-27) identified:

> "psutil is excluded on Windows via marker (sys_platform != 'win32'), so 'system' metrics likely won't work on Windows."
> Evidence: /pyproject.toml optional dependency psutil>=5.9.0; sys_platform != 'win32'.

Windows users installing fapilog with `[system]` extras may not realize that system metrics (CPU, memory, disk) are unavailable on their platform. This should be documented clearly.

---

## Scope (In / Out)

### In Scope

- Document Windows limitation in installation/extras docs
- Add note in metrics documentation
- Clarify which features are affected

### Out of Scope

- Adding Windows support for psutil (complex, external dependency issue)
- Alternative Windows metrics implementation
- Testing on Windows

---

## Acceptance Criteria

### AC1: Installation docs mention Windows limitation

**Description:** Installation documentation notes that `[system]` extras don't work on Windows.

**Validation:**
```bash
grep -i "windows\|win32" docs/user-guide/installation.md
```

### AC2: Extras table includes platform info

**Description:** Extras documentation table shows platform availability.

**Validation:**
```bash
grep -A5 "system" docs/user-guide/installation.md | grep -i "linux\|macos\|unix"
```

### AC3: Metrics docs note limitation

**Description:** Metrics documentation explains system metrics unavailability on Windows.

**Validation:**
```bash
grep -i "windows" docs/user-guide/metrics.md
```

---

## Implementation Notes

### Installation Docs Update

```markdown
## Optional Extras

| Extra | Description | Platform |
|-------|-------------|----------|
| `fastapi` | FastAPI integration | All |
| `http` | HTTP sink support | All |
| `aws` | CloudWatch sink | All |
| `metrics` | Prometheus metrics | All |
| `system` | System metrics (CPU, memory) | Linux, macOS only |
| `postgres` | PostgreSQL sink | All |

> **Note:** The `system` extra requires `psutil`, which has limited Windows support.
> System metrics enrichers will not function on Windows.
```

### Metrics Docs Update

```markdown
## System Metrics

System metrics (CPU usage, memory, disk I/O) are provided by the `runtime_info` enricher
when the `system` extra is installed.

> **Platform Note:** System metrics require `psutil`, which is only installed on
> Linux and macOS. On Windows, system metrics fields will not be populated.
>
> ```bash
> # Linux/macOS
> pip install fapilog[system]
>
> # Windows - psutil not installed, system metrics unavailable
> pip install fapilog[system]  # Installs fapilog but not psutil
> ```
```

---

## Tasks

- [ ] Update `docs/user-guide/installation.md` with platform notes
- [ ] Update `docs/user-guide/metrics.md` with Windows limitation
- [ ] Run docs build

---

## Definition of Done

- [x] Installation docs updated
- [x] Metrics docs updated
- [x] Docs build passes

---

## Related Stories

- **Origin:** GPT-5.2 External Audit (2026-01-27)

---

## Code Review

**Date:** 2026-01-27
**Reviewer:** Claude
**Verdict:** OK to PR

### Summary

Documentation-only changes adding Windows platform limitation notes for the `[system]` extra to installation and metrics documentation.

### AC Verification

| Criterion | Evidence |
|-----------|----------|
| AC1: Installation docs mention Windows limitation | `docs/getting-started/installation.md:52-53` - Note states psutil excluded on Windows |
| AC2: Extras table includes platform info | `docs/getting-started/installation.md:48` - Table shows "Linux, macOS only" for system |
| AC3: Metrics docs note limitation | `docs/core-concepts/metrics.md:19-28` - Platform Note section with Windows details |

### Quality Gates

- [x] Docs build passes
- [x] No code changes (documentation only)

---

## Change Log

| Date | Change | Author |
|------|--------|--------|
| 2026-01-27 | Initial draft from audit findings | Claude |
